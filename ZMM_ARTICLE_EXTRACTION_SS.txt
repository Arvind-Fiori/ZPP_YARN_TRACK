*&---------------------------------------------------------------------*
*&  Include           ZMM_ARTICLE_EXTRACTION_SS
*&---------------------------------------------------------------------*

*& SELECTION SCREEN
SELECTION-SCREEN BEGIN OF BLOCK B1 WITH FRAME TITLE TEXT-001.

SELECTION-SCREEN SKIP.
SELECTION-SCREEN BEGIN OF BLOCK B2 WITH FRAME TITLE TEXT-002.
SELECTION-SCREEN SKIP.
SELECT-OPTIONS      S_MATNR  FOR  MARA-MATNR MODIF ID ID3.
PARAMETERS :        P_RWERKS TYPE WERKS_D MODIF ID ID3.
PARAMETERS: CB2 AS CHECKBOX USER-COMMAND UC_EXT MODIF ID ID5.
PARAMETERS : P_DWERKS TYPE WERKS_D MODIF ID ID3.
SELECT-OPTIONS: S_MTART FOR MARA-MTART NO INTERVALS MODIF ID ID6,
                S_ATTYP FOR MARA-ATTYP NO-EXTENSION NO INTERVALS MODIF ID ID6.

SELECT-OPTIONS: S_PRCTR  FOR MARC-PRCTR NO INTERVALS NO-EXTENSION MODIF ID ID2.
SELECT-OPTIONS:  S_DLGORT FOR T001L-LGORT NO INTERVALS MODIF ID ID4.
SELECT-OPTIONS : S_MBRSH FOR MARA-MBRSH NO INTERVALS NO-EXTENSION MODIF ID ID2,
                 S_MATKL FOR MARA-MATKL NO INTERVALS NO-EXTENSION MODIF ID ID2.
PARAMETERS : P_RECORS TYPE CHAR05 MODIF ID ID3.
SELECTION-SCREEN END OF BLOCK B2.

SELECTION-SCREEN SKIP.
SELECTION-SCREEN BEGIN OF BLOCK B3 WITH FRAME TITLE TEXT-003.
SELECTION-SCREEN SKIP.

SELECTION-SCREEN BEGIN OF LINE.
SELECTION-SCREEN POSITION 1.
PARAMETERS : RB1 RADIOBUTTON GROUP RBG DEFAULT 'X' USER-COMMAND UC_RB.
SELECTION-SCREEN COMMENT 5(30) TEXT-005.

SELECTION-SCREEN POSITION 35.
PARAMETERS: CB1 AS CHECKBOX.
SELECTION-SCREEN COMMENT 40(30) TEXT-007.
SELECTION-SCREEN END OF LINE.

SELECTION-SCREEN BEGIN OF LINE.
SELECTION-SCREEN POSITION 1.
PARAMETERS : RB2 RADIOBUTTON GROUP RBG.
SELECTION-SCREEN COMMENT 5(30) TEXT-006.
SELECTION-SCREEN END OF LINE.

SELECTION-SCREEN BEGIN OF LINE.
PARAMETERS : RB3 RADIOBUTTON GROUP RBG.
SELECTION-SCREEN COMMENT 5(30) TEXT-004.
SELECTION-SCREEN END OF LINE.

SELECTION-SCREEN END OF BLOCK B3.

SELECTION-SCREEN END OF BLOCK B1.

*& AT SELECTION-SCREEN OUTPUT EVENT
AT SELECTION-SCREEN OUTPUT.

  LOOP AT SCREEN.

    IF RB1 = ABAP_TRUE.
      IF SCREEN-GROUP1 = 'ID1' OR SCREEN-GROUP1 = 'ID4' OR SCREEN-GROUP1 = 'ID5'.
        SCREEN-INVISIBLE = '1'.
        SCREEN-ACTIVE = '0'.
        MODIFY SCREEN.
      ENDIF.
    ENDIF.

    IF RB2 = ABAP_TRUE.
      IF SCREEN-GROUP1 = 'ID2' OR SCREEN-GROUP1 = 'ID6'.
        SCREEN-INVISIBLE = '1'.
        SCREEN-ACTIVE = '0'.
        MODIFY SCREEN.
      ENDIF.
      IF CB2 = ABAP_TRUE AND SCREEN-GROUP1 = 'ID4'.
        SCREEN-INVISIBLE = '1'.
        SCREEN-ACTIVE = '0'.
        MODIFY SCREEN.
      ENDIF.
    ENDIF.

    IF RB3 = ABAP_TRUE.
      IF SCREEN-GROUP1 = 'ID1' OR SCREEN-GROUP1 = 'ID2' OR SCREEN-GROUP1 = 'ID3' OR SCREEN-GROUP1 = 'ID4' OR SCREEN-GROUP1 = 'ID5' OR SCREEN-GROUP1 = 'ID6'.
        SCREEN-INVISIBLE = '1'.
        SCREEN-ACTIVE = '0'.
        MODIFY SCREEN.
      ENDIF.
    ENDIF.
  ENDLOOP.

*& AT SELECTION-SCREEN EVENT
AT SELECTION-SCREEN.

  IF RB3 = ABAP_TRUE.
    CALL TRANSACTION 'ZMM_AUTOLIST'.
  ENDIF.

  IF SY-UCOMM = 'ONLI'.

    IF RB1 = ABAP_TRUE .
      IF S_PRCTR IS INITIAL.
        MESSAGE 'Fill out all required entry fields ''''Dest Plant Profit Center''''' TYPE 'S' DISPLAY LIKE 'E'.
        LEAVE SCREEN.
      ENDIF.
    ENDIF.

    IF RB2 = ABAP_TRUE.
      IF CB2 = ABAP_FALSE AND S_DLGORT[] IS INITIAL.
        MESSAGE 'Fill out all required entry fields ''''Dest Stor Loc''''' TYPE 'S' DISPLAY LIKE 'E'.
        LEAVE SCREEN.
      ENDIF.
    ENDIF.

    IF RB1 = ABAP_TRUE OR RB2 = ABAP_TRUE.
      IF S_MATNR[] IS INITIAL.
        MESSAGE 'Fill out all required entry fields ''''Arcticle No''''' TYPE 'S' DISPLAY LIKE 'E'.
        LEAVE SCREEN.
      ENDIF.
      IF P_RWERKS IS INITIAL.
        MESSAGE 'Fill out all required entry fields ''''Ref Plant''''' TYPE 'S' DISPLAY LIKE 'E'.
        LEAVE SCREEN.
      ENDIF.
      IF P_DWERKS IS INITIAL.
        MESSAGE 'Fill out all required entry fields ''''Des Plant''''' TYPE 'S' DISPLAY LIKE 'E'.
        LEAVE SCREEN.
      ENDIF.
    ENDIF.

    IF ( RB1 = ABAP_TRUE OR RB2 = ABAP_TRUE ) AND CB1 = ABAP_TRUE AND P_RECORS IS INITIAL.
      MESSAGE 'Fill out all required entry fields ''''No of Records Per session'''' for Background Execution' TYPE 'S' DISPLAY LIKE 'E'.
      LEAVE SCREEN.
    ENDIF.
  ENDIF.